# Epic 8.0: Admin Image Management System

## Epic Status
In Progress

## Epic Overview
**As an** administrator,
**I want** a comprehensive image management system within the admin portal,
**so that** I can efficiently upload, organize, and manage images for events and projects with proper database storage and featured image capabilities.

## Epic Scope

### Objectives
1. Replace URL-based image management with direct file upload system
2. Implement proper database relationships between images and entities (Events/Projects)
3. Enable featured image selection for better content presentation
4. Provide intuitive image management UI with upload, preview, and deletion capabilities
5. Ensure data integrity through proper foreign key relationships and constraints

### Background
Currently, the admin portal requires administrators to manually enter image URLs for events and projects. This approach has several limitations:
- Images must be hosted externally before being added
- No validation or quality control over image content
- No relationship tracking between images and entities
- Difficult to manage or update images after creation
- No featured image concept for highlighting primary content

This epic introduces a comprehensive image management system that stores images directly in the database with proper relationships, provides file upload capabilities, and enables featured image selection for enhanced content presentation.

### Out of Scope
- Image editing or manipulation features
- Bulk image operations or batch uploads
- Image gallery or media library interface
- Public image upload (remains admin-only)
- Video or document file support

## Related Stories

### Story 8.1: Image Upload Backend Foundation
**Status**: Not Started

Implement the database schema and backend API for image storage, retrieval, and management with proper entity relationships.

**Key Features**:
- Image model with foreign keys to Events and Projects
- tRPC router for upload, retrieval, featured status, and deletion
- Proper database constraints and cascade delete behavior
- File validation and metadata storage

### Story 8.2: Admin Image Upload Interface
**Status**: Not Started

Create the frontend components for image upload, preview, and management within the admin portal.

**Key Features**:
- Drag & drop file upload component
- Image preview grid with thumbnails
- Featured image selection UI
- Image deletion with confirmation
- Integration with EventForm and ProjectForm components

## Epic Dependencies

### Technical Dependencies
- Existing Event and Project models in database (Epic 3, Epic 4)
- Admin portal authentication and authorization (Epic 3)
- tRPC infrastructure (Epic 3)
- File storage solution (Vercel Blob, AWS S3, or local storage)

### Data Dependencies
- Event.id and Project.id fields for foreign key relationships
- Admin user authentication for upload authorization

## Epic Success Criteria
1. ✅ Images stored directly in database with proper metadata
2. ✅ Proper foreign key relationships between Images and Events/Projects
3. ✅ Only one featured image per entity enforced by database constraints
4. ✅ Admin can upload multiple images via drag & drop
5. ✅ Admin can preview uploaded images before saving
6. ✅ Admin can delete images (cascade delete maintains data integrity)
7. ✅ Admin can set/change featured image
8. ✅ File type and size validation prevents invalid uploads
9. ✅ Backward compatibility maintained with existing photos field
10. ✅ Comprehensive test coverage for all new functionality

## Epic Timeline
- **Start Date**: October 2, 2025
- **Target Completion**: TBD
- **Estimated Effort**: 2-3 weeks

## Epic Notes

### Architecture Decisions
1. **Polymorphic Relationship**: Single Image model serves both Events and Projects using foreign keys
2. **Backward Compatibility**: Maintain existing `photos: String[]` fields during transition
3. **Cascade Delete**: When Event/Project deleted, associated images automatically removed
4. **Unique Constraints**: Database-level enforcement of one featured image per entity

### Security Considerations
- File upload restricted to authenticated admin users
- File type validation prevents malicious uploads
- File size limits prevent storage abuse
- Proper input sanitization for filenames and metadata

### Performance Considerations
- Image optimization on upload (resize, compress)
- Lazy loading for image previews
- Efficient database queries with proper indexing
- CDN integration for image delivery (future enhancement)

## Related Documentation
- [Database Schema](../architecture/9-database-schema.md)
- [API Specification](../architecture/5-api-specification.md)
- [Admin Portal Stories](./3.2.admin-portal-create-view-events.md)
- [Project Brief](../Project-Brief.md)
